<!DOCTYPE html>
<html lang="el">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· ÎŸÏ‡Î·Î¼Î¬Ï„Ï‰Î½</title>
    <link rel="icon" type="image/png" href="/favicon.png" />
    <!-- ğŸ”’ Route protection: if not logged in, redirect to login.html -->
    <script src="auth-guard.js"></script>

    <link rel="stylesheet" href="vehicles.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <div class="header-vehicle">
          <!-- Î Î¬Î½Ï‰ ÏƒÎµÎ¹ÏÎ¬: Î¤Î¯Ï„Î»Î¿Ï‚ + hamburger Î”Î™Î Î›Î‘ -->
          <div class="vehicles-header-main">
            <h1>Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· ÎŸÏ‡Î·Î¼Î¬Ï„Ï‰Î½</h1>
            <button class="nav-toggle" type="button" aria-label="Î†Î½Î¿Î¹Î³Î¼Î± Î¼ÎµÎ½Î¿Ï">
              <span></span>
              <span></span>
              <span></span>
            </button>
          </div>

          <!-- ÎšÎ¬Ï„Ï‰ ÏƒÎµÎ¹ÏÎ¬: ÎœÎµÎ½Î¿Ï -->
          <div class="header-content-vehicle">
            <nav>
              <a href="dashboard.html">Î Î¯Î½Î±ÎºÎ±Ï‚</a>
              <a href="vehicles.html" class="active">ÎŸÏ‡Î®Î¼Î±Ï„Î±</a>
              <a href="maintenance.html">Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ·</a>
              <a href="costs.html">ÎšÏŒÏƒÏ„Î·</a>
              <a href="account.html">Î›Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒÏ‚</a>
            </nav>
          </div>
        </div>
      </header>

      <main>
        <div class="page-header">
          <h2>ÎŸÏ‡Î®Î¼Î±Ï„Î± Î•Ï„Î±Î¹ÏÎµÎ¯Î±Ï‚</h2>
          <button class="btn-primary" onclick="showAddVehicleForm()">
            + Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎÎ­Î¿Ï… ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚
          </button>
        </div>

        <!-- Î¦ÏŒÏÎ¼Î± Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ·Ï‚ ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚ -->
        <div id="addVehicleModal" class="modal" style="display: none">
          <div class="modal-content">
            <span class="close" onclick="closeAddVehicleForm()">&times;</span>
            <h3>Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎÎ­Î¿Ï… ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚</h3>
            <form id="vehicleForm">
              <div class="form-row">
                <!-- Î¤ÏÏ€Î¿Ï‚ ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚ -->
                <div class="form-group">
                  <label for="vehicleType">Î¤ÏÏ€Î¿Ï‚ ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚ *</label>
                  <select id="vehicleType" name="vehicleType" required>
                    <option value="" disabled selected>Î•Ï€Î¹Î»Î­Î¾Ï„Îµ...</option>
                    <option value="Î•Ï€Î¹Î²Î±Ï„Î¹ÎºÏŒ Î™Î§">Î•Ï€Î¹Î²Î±Ï„Î¹ÎºÏŒ Î™Î§</option>
                    <option value="ÎœÎ¿Ï„Î¿ÏƒÏ…ÎºÎ»Î­Ï„Î±">ÎœÎ¿Ï„Î¿ÏƒÏ…ÎºÎ»Î­Ï„Î±</option>
                    <option value="Î¦Î¿ÏÏ„Î·Î³ÏŒ ÎœÎµÏƒÎ±Î¯Î¿Ï… Î¤ÏÏ€Î¿Ï…">
                      Î¦Î¿ÏÏ„Î·Î³ÏŒ ÎœÎµÏƒÎ±Î¯Î¿Ï… Î¤ÏÏ€Î¿Ï…
                    </option>
                    <option value="Î¦Î¿ÏÏ„Î·Î³ÏŒ Î’Î±ÏÎ­Ï‰Ï‚ Î¤ÏÏ€Î¿Ï…">
                      Î¦Î¿ÏÏ„Î·Î³ÏŒ Î’Î±ÏÎ­Ï‰Ï‚ Î¤ÏÏ€Î¿Ï…
                    </option>
                    <option value="Î›ÎµÏ‰Ï†Î¿ÏÎµÎ¯Î¿">Î›ÎµÏ‰Ï†Î¿ÏÎµÎ¯Î¿</option>
                    <option value="Î¡Ï…Î¼Î¿Ï…Î»ÎºÎ¿ÏÎ¼ÎµÎ½Î¿">Î¡Ï…Î¼Î¿Ï…Î»ÎºÎ¿ÏÎ¼ÎµÎ½Î¿</option>
                    <option value="Î—Î¼Î¹ÏÏ…Î¼Î¿Ï…Î»ÎºÎ¿ÏÎ¼ÎµÎ½Î¿">Î—Î¼Î¹ÏÏ…Î¼Î¿Ï…Î»ÎºÎ¿ÏÎ¼ÎµÎ½Î¿</option>
                    <option value="other">Î†Î»Î»Î¿â€¦</option>
                  </select>

                  <input
                    type="text"
                    id="vehicleTypeOther"
                    name="vehicleTypeOther"
                    placeholder="Î Î»Î·ÎºÏ„ÏÎ¿Î»ÏŒÎ³Î·ÏƒÎµ Ï„ÏÏ€Î¿ Î¿Ï‡Î®Î¼Î±Ï„Î¿Ï‚"
                    style="display: none; margin-top: 8px"
                  />
                </div>

                <div class="form-group">
                  <label for="chassisNumber">Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î Î»Î±Î¹ÏƒÎ¯Î¿Ï… *</label>
                  <input
                    type="text"
                    id="chassisNumber"
                    name="chassisNumber"
                    required
                  />
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="model">ÎœÎ¿Î½Ï„Î­Î»Î¿</label>
                  <input type="text" id="model" />
                </div>
                <div class="form-group">
                  <label for="year">ÎˆÏ„Î¿Ï‚</label>
                  <input type="number" id="year" min="1990" max="2024" />
                </div>
              </div>

              <div class="form-group">
                <label for="currentMileage">Î¤ÏÎ­Ï‡Î¿Î½Ï„Î± Î§Î¹Î»Î¹ÏŒÎ¼ÎµÏ„ÏÎ±</label>
                <input type="number" id="currentMileage" value="0" />
              </div>

              <div class="form-actions">
                <button
                  type="button"
                  class="btn-secondary"
                  data-action="cancel"
                >
                  Î‘ÎºÏÏÏ‰ÏƒÎ·
                </button>

                <button type="submit" class="btn-secondary">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
              </div>
            </form>
          </div>
        </div>

        <!-- Î¦ÏŒÏÎ¼Î± Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚ ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚ -->
        <!-- <div id="editVehicleModal" class="modal" style="display: none">
          <div class="modal-content">
            <span class="close" onclick="closeEditVehicleModal()">&times;</span>
            <h3>Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚</h3>
            <form id="editVehicleForm">
              <input type="hidden" id="editVehicleId" />

              <div class="form-section">
                <h4>Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚</h4>
                <div class="form-row">
                  <div class="form-group">
                    <label for="editChassisNumber">Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î Î»Î±Î¹ÏƒÎ¯Î¿Ï… *</label>
                    <input type="text" id="editChassisNumber" required />
                  </div>
                  <div class="form-group">
                    <label for="editVehicleType">Î¤ÏÏ€Î¿Ï‚ ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚ *</label>

                    <input type="text" id="editVehicleType" required />
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label for="editModel">ÎœÎ¿Î½Ï„Î­Î»Î¿</label>
                    <input type="text" id="editModel" />
                  </div>
                  <div class="form-group">
                    <label for="editYear">ÎˆÏ„Î¿Ï‚</label>
                    <input type="number" id="editYear" min="1990" max="2024" />
                  </div>
                </div>

                <div class="form-group">
                  <label for="editCurrentMileage">Î¤ÏÎ­Ï‡Î¿Î½Ï„Î± Î§Î¹Î»Î¹ÏŒÎ¼ÎµÏ„ÏÎ±</label>
                  <input type="number" id="editCurrentMileage" value="0" />
                </div>
              </div>

              <div class="form-actions">
                <button
                  type="button"
                  class="btn-secondary"
                  onclick="closeEditVehicleModal()"
                >
                  Î‘ÎºÏÏÏ‰ÏƒÎ·
                </button>
                <button type="submit" class="btn-primary">
                  Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î‘Î»Î»Î±Î³ÏÎ½
                </button>
              </div>
            </form>
          </div>
        </div> -->
        <!-- EDIT VEHICLE MODAL -->
        <div id="editVehicleModal" class="modal">
          <div class="modal-content large">
            <span class="close">&times;</span>
            <h2>Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚</h2>

            <form id="editVehicleForm">
              <input type="hidden" id="editVehicleId" />

              <!-- 1Î· ÏƒÎµÎ¹ÏÎ¬: Î¤ÏÏ€Î¿Ï‚ ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚ (ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ add) + Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î Î»Î±Î¹ÏƒÎ¯Î¿Ï… -->
              <div class="form-row">
                <div class="form-group">
                  <label for="editVehicleType">Î¤ÏÏ€Î¿Ï‚ ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚ *</label>
                  <select id="editVehicleType" required>
                    <option value="" disabled selected>Î•Ï€Î¹Î»Î­Î¾Ï„Îµ...</option>

                    <!-- Î’Î‘Î›Î• Î‘ÎšÎ¡Î™Î’Î©Î£ Î¤Î™Î£ Î™Î”Î™Î•Î£ Î•Î Î™Î›ÎŸÎ“Î•Î£ ÎœÎ• Î¤ÎŸ add -->
                    <option value="Î•Ï€Î¹Î²Î±Ï„Î¹ÎºÏŒ Î™Î§">Î•Ï€Î¹Î²Î±Ï„Î¹ÎºÏŒ Î™Î§</option>
                    <option value="ÎœÎ¿Ï„Î¿ÏƒÏ…ÎºÎ»Î­Ï„Î±">ÎœÎ¿Ï„Î¿ÏƒÏ…ÎºÎ»Î­Ï„Î±</option>
                    <option value="Î¦Î¿ÏÏ„Î·Î³ÏŒ ÎœÎµÏƒÎ±Î¯Î¿Ï… Î¤ÏÏ€Î¿Ï…">
                      Î¦Î¿ÏÏ„Î·Î³ÏŒ ÎœÎµÏƒÎ±Î¯Î¿Ï… Î¤ÏÏ€Î¿Ï…
                    </option>
                    <option value="Î¦Î¿ÏÏ„Î·Î³ÏŒ Î’Î±ÏÎ­Ï‰Ï‚ Î¤ÏÏ€Î¿Ï…">
                      Î¦Î¿ÏÏ„Î·Î³ÏŒ Î’Î±ÏÎ­Ï‰Ï‚ Î¤ÏÏ€Î¿Ï…
                    </option>
                    <option value="Î›ÎµÏ‰Ï†Î¿ÏÎµÎ¯Î¿">Î›ÎµÏ‰Ï†Î¿ÏÎµÎ¯Î¿</option>
                    <option value="Î¡Ï…Î¼Î¿Ï…Î»ÎºÎ¿ÏÎ¼ÎµÎ½Î¿">Î¡Ï…Î¼Î¿Ï…Î»ÎºÎ¿ÏÎ¼ÎµÎ½Î¿</option>
                    <option value="Î—Î¼Î¹ÏÏ…Î¼Î¿Ï…Î»ÎºÎ¿ÏÎ¼ÎµÎ½Î¿">Î—Î¼Î¹ÏÏ…Î¼Î¿Ï…Î»ÎºÎ¿ÏÎ¼ÎµÎ½Î¿</option>
                    <option value="other">Î†Î»Î»Î¿â€¦</option>
                  </select>
                  <input
                    type="text"
                    id="editVehicleTypeOther"
                    placeholder="Î Î»Î·ÎºÏ„ÏÎ¿Î»ÏŒÎ³Î·ÏƒÎµ Ï„ÏÏ€Î¿ Î¿Ï‡Î®Î¼Î±Ï„Î¿Ï‚"
                    style="display: none; margin-top: 8px"
                  />
                </div>

                <div class="form-group">
                  <label for="editChassisNumber">Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î Î»Î±Î¹ÏƒÎ¯Î¿Ï… *</label>
                  <input type="text" id="editChassisNumber" required />
                </div>
              </div>

              <!-- 2Î· ÏƒÎµÎ¹ÏÎ¬: ÎœÎ¿Î½Ï„Î­Î»Î¿ + ÎˆÏ„Î¿Ï‚ (Î¯Î´Î¹Î± ÏƒÎµÎ¹ÏÎ¬ Î¼Îµ add) -->
              <div class="form-row">
                <div class="form-group">
                  <label for="editModel">ÎœÎ¿Î½Ï„Î­Î»Î¿</label>
                  <input type="text" id="editModel" />
                </div>

                <div class="form-group">
                  <label for="editYear">ÎˆÏ„Î¿Ï‚</label>
                  <input type="number" id="editYear" min="1900" max="2100" />
                </div>
              </div>

              <!-- 3Î· ÏƒÎµÎ¹ÏÎ¬: Î¤ÏÎ­Ï‡Î¿Î½Ï„Î± Î§Î¹Î»Î¹ÏŒÎ¼ÎµÏ„ÏÎ± -->
              <div class="form-group">
                <label for="editCurrentMileage">Î¤ÏÎ­Ï‡Î¿Î½Ï„Î± Î§Î¹Î»Î¹ÏŒÎ¼ÎµÏ„ÏÎ±</label>
                <input
                  type="number"
                  id="editCurrentMileage"
                  min="0"
                  value="0"
                />
              </div>

              <!-- ÎšÎ¿Ï…Î¼Ï€Î¹Î¬ (Î¯Î´Î¹Î¿ ÏƒÏ„Ï…Î») -->
              <div class="modal-actions">
                <button
                  type="button"
                  class="btn-secondary"
                  id="cancelEditVehicle"
                  data-action="cancel"
                >
                  Î‘ÎºÏÏÏ‰ÏƒÎ·
                </button>
                <button type="submit" class="btn-secondary">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
              </div>
            </form>
          </div>
        </div>

        <!-- Î›Î¯ÏƒÏ„Î± ÎŸÏ‡Î·Î¼Î¬Ï„Ï‰Î½ -->
        <div class="vehicles-table-container">
          <table id="vehiclesTable" class="data-table">
            <thead>
              <tr>
                <th>Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î Î»Î±Î¹ÏƒÎ¯Î¿Ï…</th>
                <th>Î¤ÏÏ€Î¿Ï‚ ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚</th>
                <th>ÎœÎ¿Î½Ï„Î­Î»Î¿</th>
                <th>ÎˆÏ„Î¿Ï‚</th>
                <th>Î§Î¹Î»Î¹ÏŒÎ¼ÎµÏ„ÏÎ±</th>
                <th>Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚</th>
              </tr>
            </thead>
            <tbody id="vehiclesTableBody">
              <!-- Î˜Î± Î³ÎµÎ¼Î¯ÏƒÎµÎ¹ Î¼Îµ JavaScript -->
            </tbody>
          </table>
        </div>
      </main>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // ADD modal
        const select = document.getElementById("vehicleType");
        const other = document.getElementById("vehicleTypeOther");

        function toggleOther() {
          const isOther = select.value === "other";
          other.style.display = isOther ? "block" : "none";
          other.required = isOther;
          if (!isOther) other.value = "";
        }

        if (select && other) {
          select.addEventListener("change", toggleOther);
        }

        // EDIT modal
        const editSelect = document.getElementById("editVehicleType");
        const editOther = document.getElementById("editVehicleTypeOther");

        function toggleEditOther() {
          const isOther = editSelect.value === "other";
          editOther.style.display = isOther ? "block" : "none";
          editOther.required = isOther;
          if (!isOther) editOther.value = "";
        }

        if (editSelect && editOther) {
          editSelect.addEventListener("change", toggleEditOther);
        }
        const navToggle = document.querySelector(".nav-toggle");

        if (navToggle) {
          navToggle.addEventListener("click", function () {
            document.body.classList.toggle("nav-open");
          });
        }

        /* ================================
           Mobile cards (ÏŒÏ€Ï‰Ï‚ costs)
           - Ï€ÏÎ¿ÏƒÎ¸Î­Ï„ÎµÎ¹ data-label ÏƒÏ„Î± <td>
           - Î²Î¬Î¶ÎµÎ¹ class vehicle-item ÏƒÏ„Î± <tr>
           ================================ */
        const vehiclesTbody = document.getElementById("vehiclesTableBody");
        const vehiclesTable = document.getElementById("vehiclesTable");

        const getHeaderLabels = () => {
          const ths = vehiclesTable?.querySelectorAll("thead th");
          if (!ths || ths.length === 0) {
            return [
              "Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î Î»Î±Î¹ÏƒÎ¯Î¿Ï…",
              "Î¤ÏÏ€Î¿Ï‚ ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚",
              "ÎœÎ¿Î½Ï„Î­Î»Î¿",
              "ÎˆÏ„Î¿Ï‚",
              "Î§Î¹Î»Î¹ÏŒÎ¼ÎµÏ„ÏÎ±",
              "Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚",
            ];
          }
          return Array.from(ths).map((th) => th.textContent.trim());
        };

        const decorateVehicleRows = () => {
          if (!vehiclesTbody) return;
          const labels = getHeaderLabels();
          vehiclesTbody.querySelectorAll("tr").forEach((tr) => {
            tr.classList.add("vehicle-item");
            const tds = tr.querySelectorAll("td");
            tds.forEach((td, idx) => {
              if (!td.getAttribute("data-label")) {
                td.setAttribute("data-label", labels[idx] || "");
              }
            });
          });
        };

        // 1) Ï„ÏÎ­Ï‡ÎµÎ¹ Î¼Î¹Î± Ï†Î¿ÏÎ¬ (ÏƒÎµ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Î®Î´Î· Î³ÎµÎ¼Î¯ÏƒÎµÎ¹)
        decorateVehicleRows();

        // 2) Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Î±Î»Î»Î±Î³Î­Ï‚ Î±Ï€ÏŒ vehicles.js (ÏŒÏ„Î±Î½ Î³ÎµÎ¼Î¯Î¶ÎµÎ¹/Î±Î»Î»Î¬Î¶ÎµÎ¹ Ï„Î¿ tbody)
        if (vehiclesTbody) {
          const observer = new MutationObserver(() => decorateVehicleRows());
          observer.observe(vehiclesTbody, { childList: true, subtree: true });
        }
      });
    </script>

    <script src="api.js"></script>
    <script src="vehicles.js"></script>
  </body>
  <footer class="footer">
    <div class="footer-divider"></div>

    <div class="footer-content">
      <div class="footer-left">
        <h3>Panagiotis Eleftheriadis</h3>
        <p>Applied Informatics â€¢ Web & Software Development</p>
      </div>

      <div class="footer-center">
        <a href="#top">Back to top â†‘</a>
      </div>

      <div class="footer-right">
        <p>
          Â© <span id="year"></span><br />
          All rights reserved
        </p>
      </div>
    </div>
  </footer>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>
</html>
